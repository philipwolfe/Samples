



    <link rel="stylesheet" href="../../../../util/style.css">

    <form name="Form" method="post" action="srcview.htm?path=/QuickStart/aspplus/samples/classbrowser/classbrowser.src&file=VB/classbrowser.htm" id="Form">
<input type="hidden" name="__VIEWSTATE" value="YTB6MTQ3MzAyNjM4MF9hMHpfaHo1ejN4X2Ewel9oejV6MHhfYTB6aHppbm5lcmh0bWxfVkIvY2xhc3Nicm93c2VyLmFzcFx4eF9feHhfeHhfeF9feA==9edeab62" />


        <div class="SampleHeader" style="width:100%">
            <div class="SampleTitle">
                <span id="Title">VB/classbrowser.htm</span>
            </div>
            <table id="SourceTable" style="font: 8pt Verdana">
    <tr>
        <td style="padding-right:10;"><b>C# Source: </b></td>
        <td><a href='../../../../aspplus/samples/classbrowser/classbrowseraspxsource.htm'>classbrowser.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/classbrowser/classinfocssource.htm'>classInfo.cs</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/classbrowser/makesamplebatsource.htm'>makesample.bat</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/classbrowser/configwebsource.htm'>config.web</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/classbrowser/classstylecsssource.htm'>classstyle.css</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b>VB Source: </b></td>
        <td><a href='../../../../aspplus/samples/classbrowser/vb/classbrowseraspxsource.htm'>VB/classbrowser.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/classbrowser/vb/classinfocssource.htm'>VB/classInfo.cs</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/classbrowser/vb/makesamplebatsource.htm'>VB/makesample.bat</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/classbrowser/vb/configwebsource.htm'>VB/config.web</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/classbrowser/classstylecsssource.htm'>classstyle.css</a> &nbsp;&nbsp</td>
    </tr>
</table>

        </div>

        <xmp><%@ Page Debug="false" %> 
<%@ Import NameSpace="ClassInfo" %>  
<%@ Import NameSpace="System.Collections"  %> 
<%@ Import NameSpace="System.Reflection" %> 

<html>
<head>
	<link rel="stylesheet" href="../classstyle.css">
    <title>.NET Framework Class Browser</title>  

    <script runat="server" language="vb">
        
        public SelectedNameSpace as string    
        public ModuleName as new ArrayList

        '
        ' Page_Load
        '
        protected sub Page_Load( ByVal Sender as Object, ByVal e as EventArgs )
            dim ConfigSettings as new Hashtable
            ConfigSettings = Context.GetConfig("ClassBrowser")
            Dim SettingsEnum as IEnumerator = ConfigSettings.Values.GetEnumerator()

            for i = 0 to ConfigSettings.Count - 1
                SettingsEnum.MoveNext ()
                ModuleName.Add( SettingsEnum.Current.ToString() )
            next

            DisplayNamespaces()  

            if ( Request.QueryString("namespace") <> "" )
                SelectedNameSpace = Request.QueryString("namespace")
            else
                SelectedNameSpace = "System"
            end if

            if ( Request.QueryString("class") <> "" )
                DisplayClass( Request.QueryString("class") )
            else
                DisplayClassList( SelectedNameSpace )
            end if
        end sub
       
        '
        ' DisplayNamespaces
        '
        private sub DisplayNamespaces
            Dim NameSpaceList as ArrayList = new ArrayList()
            Dim NameSpaceHash as Hashtable = new Hashtable()

            for y = 0 to ModuleName.Count-1

                Dim CorRuntime() as System.Reflection.Module = System.Reflection.Assembly.Load(ModuleName(y).ToString()).GetModules()
                Dim CorClasses() as Type   = CorRuntime(0).GetTypes()

                for x=0 to CorClasses.Length-1

                    if (not NameSpaceHash.ContainsKey(CorClasses(x).Namespace) and CorClasses(x).IsPublic )
                        NameSpaceHash.Add(CorClasses(x).Namespace,"")
											NameSpaceList.Add(CorClasses(x).Namespace)
                    end if
                next
            next

            NameSpaceList.Sort()
            Namespace1.DataSource = NameSpaceList
            Namespace1.DataBind()
        end sub

        '
        ' DisplayClassList
        '
        private sub DisplayClassList(ByVal CurrentNameSpace as string)
            dim ClassList as ArrayList = new ArrayList()
            dim InterfaceList as ArrayList = new ArrayList()

            for y=0 to ModuleName.Count-1

                dim CorRuntime() as System.Reflection.Module = System.Reflection.Assembly.Load(ModuleName(y).ToString()).GetModules()
                dim CorClasses() as Type	 = CorRuntime(0).GetTypes()

                for x=0 to CorClasses.Length-1

                    if ( CorClasses(x).Namespace = CurrentNameSpace and CorClasses(x).IsPublic) 

                        if ( CorClasses(x).IsInterface ) 
                            InterfaceList.Add(CorClasses(x).Name)
                        else
                            ClassList.Add(CorClasses(x).Name)
						end if
                    end if
                next  
            next
          
            if (InterfaceList.Count > 0)
                IHeader.Visible = true
			end if

            if (ClassList.Count > 0)
               CHeader.Visible = true
			end if

            ClassList.Sort()
            Classes.DataSource = ClassList
            Classes.DataBind()

            InterfaceList.Sort()
            Interfaces.DataSource = InterfaceList
            Interfaces.DataBind()
        end sub
		
		'
        ' DisplayClass
        '
		' show details for a specific class
		'
        private sub DisplayClass( ByVal className as String ) 
            Dim ClassType		as Type = Type.GetType( SelectedNameSpace + "." + className )
            Dim SubClassDetails as ArrayList = new DisplaySubClasses( ClassType, ModuleName )

            dim ConstructorDetails as DisplayConstructors  =  new DisplayConstructors( ClassType )
            dim FieldDetails as DisplayFields              =  new DisplayFields( ClassType )
            dim PropertyDetails as DisplayProperties       =  new DisplayProperties( ClassType )
            dim MethodDetails as DisplayMethods            =  new DisplayMethods( ClassType, className )
            dim SuperClassDetails as DisplaySuperclasses   =  new DisplaySuperclasses( ClassType )
            dim InterfaceDetails as DisplayInterfaces      =  new DisplayInterfaces( ClassType )

            if( ConstructorDetails.Count <> 0 )
                Constructors.DataSource = ConstructorDetails
			end if
            if( SubClassDetails.Count <> 0 )
                SubClasses.DataSource = SubClassDetails
			end if
            if( FieldDetails.Count <> 0 )
                Fields.DataSource = FieldDetails
			end if
            if( PropertyDetails.Count <> 0 )
                Properties.DataSource = PropertyDetails
			end if
            if( MethodDetails.Count <> 0 ) 
                Methods.DataSource = MethodDetails
			end if
            if( InterfaceDetails.Count <> 0 )
                Interface1.DataSource = InterfaceDetails
			end if
            if( SuperClassDetails.Count <> 0 )
                SuperClasses.DataSource = SuperClassDetails
            end if
            DataBind()

            if (ClassType.IsInterface) 
                spnClassName.InnerHtml = "Interface " + SelectedNameSpace + "." + className
            else
                spnClassName.InnerHtml = "Class " + SelectedNameSpace + "." + className
			end if
            NameSpacePanel.Visible=false
            ClassPanel.Visible=true
        end sub

        '
        ' GetUrl
        '
        public function GetUrl(ByVal table as Hashtable) as String 
            return "classbrowser.htm?namespace=" + table("Namespace") + "&class=" + table("GetType")
        end function

    </script>

</head>	
<body> 
  <form runat="server">
    <table class="top" width=100% height="40" cellpadding=0 cellspacing=0>
      <tr>
        <td bgcolor=#000666>
          <b><font size=5 color=white>.NET Framework Class Browser</b>
        </td>
      </tr>
    </table>
    
    <table width=100% height=700 cellpadding=0 cellspacing=0>
      <tr>
        <td width=25% bgcolor=#CCCCFF valign=top > 
          <br> 
            <asp:DataList MaintainState="false" runat=server id="Namespace1" 
               RepeatLayOut="flow" ItemStyle-Font-Size="9pt" HeaderStyle-Font-Size="12pt" >
              <template name="headertemplate">
                <div left-margin="10">  <font size=4> <b>Namespaces</b>  </font> <br>
              </template>
               
              <template name="itemtemplate">
                <asp:HyperLink runat="server" text=<%# Container.DataItem %> NavigateUrl=<%# "classbrowser.htm?namespace=" + Container.DataItem %> />
              </template>
                        
              <template name="selecteditemtemplate">
                <b><asp:HyperLink  runat=server text=<%# Container.DataItem %>/></b>
              </template>
            </asp:DataList>                         
            <p>
        </td>
   
        <td valign=top >

         <div id="ClassPanel" style="margin-top:15;margin-left:10" visible="false" runat="server">
            <b><font size=4 color="000666"><span style="text-indent:8" id="spnClassName" MaintainState="false" runat="server"/></font></b>
         </div>

          <div id="NameSpacePanel" runat="server">

          <table class="main" width=100%>
            <tr>
              <td class="main_header"> 
                <span runat=server id="CHeader" visible="false" style="text-indent:8"> <b><font size=4 color=#000666>Classes in 
                  <%= SelectedNameSpace %>  </b> </font></span> 
              </td>
            </tr>
            <tr>
              <td align="left">
                <asp:DataList MaintainState="false" runat=server id="Classes" RepeatColumns="3" Gridlines=None borderstyle=none borderwidth=0 >
                  <template name="itemtemplate">
                    <asp:HyperLink runat=server text=<%# Container.DataItem %> NavigateUrl=<%# "classbrowser.htm?namespace=" + SelectedNameSpace + "&class=" + Container.DataItem %> />
                  </template>
                </asp:DataList>
              </td>
            </tr>
          </table>

          <table class="main" width=100% >
            <tr>
              <td class="main_header" >
                <span runat=server id="IHeader" visible="false" style="text-indent:8"> <b><font size=4 color=#000666>Interfaces in
                   <%= SelectedNameSpace %>  </font> </b> </span>
              </td>
            </tr>
            <tr>
              <td align="left">  
                <asp:DataList MaintainState="false" runat=server id="Interfaces" RepeatColumns="4" 
                  Gridlines=None borderstyle=none borderwidth=0 >
                  <template name="itemtemplate">
                    <asp:HyperLink runat=server  text=<%# Container.DataItem %> NavigateUrl=<%# "classbrowser.htm?namespace=" + SelectedNameSpace + "&class=" + Container.DataItem %>/> 
                  </template> 
                </asp:DataList> 
              </td>
            </tr>
          </table>

          </div>

          <table class="main" width=100% cellpadding=0 cellspacing=0 >
            <tr>
              <td class="main_header" valign="top" >
                <asp:DataList MaintainState="false" id="Constructors" runat="server" Gridlines=None borderstyle="none" borderwidth=0  width="100%">
                  <template name="headertemplate" >
                    <table cellspacing=0 width="100%">
                      <tr><td class="class_header"><b><font size=2> Constructors </font></b></td></tr>
                      <tr bgcolor="eeeeee">
                        <td width="75" > <b><u> Visibility     </u> </td>
                        <td width="100"> <b><u> Constructor    </u> </td>
                        <td> <b><u> Parameters     </u> </td>
                      </tr>
                  </template>

                  <template name="itemtemplate">  
                    <tr bgcolor="eeeeee">
                      <td width="75">
                        <span runat=server InnerHtml=<%# Container.DataItem.Item("Access") %> /> 
                      </td>
                      <td width="100">
                        <span runat=server InnerHtml =<%# Container.DataItem.Item("Name") %> />                                                                                    </td>
                      <td width="1000">  
                        <asp:DataList MaintainState="false" runat=server RepeatDirection="Horizontal"  RepeatLayout=Flow  showfooter=true
                           datasource=<%# Container.DataItem.Item("Params")%> >
                           <template name="headertemplate" > ( </template>    
                           <template name="itemtemplate" runat=server>
                             <asp:HyperLink text=<%# Container.DataItem.Item("ParamType") %> NavigateUrl=<%# GetURL(Container.DataItem) %> runat=server />  
                             <span innerhtml=<%# Container.DataItem.Item("ParamName") %> runat=server />
                           </template>
                           <template name="separatortemplate">, </template> 
                           <template name="footertemplate" > ) </template>
                         </asp:DataList>    
                       </td>
                     </tr>
                   </template>
                   <template name="footertemplate">
                     </table>
                   </template>
                 </asp:DataList>  
                                
                 <p>

                 <asp:DataList MaintainState="false" id="Fields" runat="server" 
                   Gridlines=None BorderStyle="none"  width="100%" BorderWidth=0>
           
                   <template name="headertemplate">
                     <table cellspacing=0  width="100%">
                       <tr><td class="class_header"><b><font size=2> Fields </font></b></td></tr>
                       <tr bgcolor="eeeeee">
                         <td width="120" ><b><u> Visibility </td>
                         <td width="100"><b><u> Type       </td>
                         <td ><b><u> Name       </td>
                       </tr>
                     </template>
      
                     <template name="itemtemplate">   
                       <tr bgcolor="eeeeee">
                         <td width="120">
                           <nobr><span InnerHTML=<%#Container.DataItem.Item("Access")%> runat=server /></nobr>
                         </td>
                         <td width="100">
                           <asp:HyperLink text=<%#Container.DataItem.Item("Type") %> NavigateUrl=<%# GetURL(Container.DataItem) %> runat=server/>   
                         </td>
                         <td>
                           <span InnerHTML=<%#Container.DataItem.Item("Name") %> runat=server /> 
                         </td>
                      </tr>
                    </template>  

                    <template name="footertemplate">
                      </table>
                    </template>
                  </asp:DataList> 
                            
                  <p>

                  <asp:DataList MaintainState="false" id="Properties" runat="server" 
                       Gridlines=None BorderStyle="none" BorderWidth=0 width="100%">

                    <template name="headertemplate">
                      <table cellspacing=0 width="100%" >
                        <tr><td class="class_header"><b><font size=2> Properties </font></b></td></tr>
                        <tr bgcolor="eeeeee">
                          <td width="75"><b><u>Visibility</td>
                          <td width="100"><b><u>Type</td>
                          <td width="150"><b><u>Name</td>
                          <td><b><u>Accessibility</td>
                        </tr>
                      </template>

                      <template name="itemtemplate">   
                        <tr bgcolor="eeeeee">
                          <td width="75"><span InnerHTML=<%# Container.DataItem.Item("Visibility") %> runat=server /> </td>
                          <td width="100">
                            <asp:HyperLink runat=server runat="server" text=<%#Container.DataItem.Item("Type") %> NavigateUrl=<%# GetURL(Container.DataItem) %>/> </td>
                          <td width="150"><span InnerHTML=<%#Container.DataItem.Item("Name")%> runat=server/> 
                            <asp:DataList MaintainState="false" runat=server RepeatLayout="Flow" ShowFooter=true
                              RepeatDirection="Horizontal"  datasource=<%#Container.DataItem.Item("Params") %>>
                              <template name="itemtemplate">                           
                                ( <asp:HyperLink runat=server text=<%#Container.DataItem.Item("ParamType")%> NavigateUrl=<%# GetURL(Container.DataItem) %>  />  
                                <span InnerHtml=<%#Container.DataItem.Item("ParamName") %> runat=server /> )
                              </template>
                            </asp:DataList>
                                             
                          </td>
                          <td><span InnerHTML=<%#Container.DataItem.Item("Access")%> runat=server/></td>
                         </tr>
                       </template>  
                     <template name="footertemplate">
                       </table>
                     </template>
                   </asp:DataList>     
                 
                   <p>
      
                  <asp:DataList MaintainState="false" id="Methods" runat="server" 
                    Gridlines=None borderstyle="none" borderwidth="0" width="100%">
                   
                    <template name="headertemplate">
                      <table cellspacing=0  >
                        <tr><td class="class_header"><b><font size=2> Methods </font></b></td></tr>
                        <tr bgcolor="eeeeee">
                          <td width="75" ><b><u>Visibility</td>
                          <td width="100"><b><u>Return </td>
                          <td width="100"><b><u>Name</td>
                          <td width="600"><b><u>Parameters</td>
                        </tr>
                      </template>
                      <template name="itemtemplate">   
                        <tr bgcolor="eeeeee">
                          <td  width="75"><nobr><span runat=server InnerHtml=<%#Container.DataItem.Item("Access")%> /></nobr></td>
                          <td width="100">
                            <asp:HyperLink runat=server NavigateUrl=<%# GetURL(Container.DataItem) %> text=<%#Container.DataItem.Item("Type")%>/>
                          </td> 
                          <td width="100"><span runat=server InnerHtml=<%#Container.DataItem.Item("Name")%>/></td> 
                          <td  width="900">
                            <asp:DataList MaintainState="false" runat=server  
                            datasource=<%#Container.DataItem.Item("Params") %>
                            RepeatLayout=Flow RepeatDirection="Horizontal" showfooter=true >
                              <template name="headertemplate">
                                (
                              </template>
                              <template name="itemtemplate">
                                <asp:HyperLink text=<%#Container.DataItem.Item("ParamType")%> NavigateUrl=<%# GetURL(Container.DataItem) %> runat=server />  
                                <span InnerHtml=<%#Container.DataItem.Item("ParamName") %>  runat=server />
                              </template>
                              <template name="separatortemplate"> ,</template>  
                              <template name="footertemplate">
                                )
                              </template>
                            </asp:DataList> 
                          </td>
                        </tr>
                      </template>  
                                    
                      <template name="footertemplate" >
                        </table>
                      </template>
                    </asp:DataList>  
                                
                    <p>   
                     
                    <asp:DataList MaintainState="false" id="SuperClasses" style="margin-left:10" runat="server" RepeatLayout="Flow"
                       RepeatDirection="horizontal"  width="100%">
                    
                      <template name="headertemplate">
                        <font size=2><b> Hierarchy </b></font> <br>
                      </template>  

                      <template name="itemtemplate">   
                        <asp:HyperLink runat=server NavigateUrl=<%# GetURL(Container.DataItem) %> text=<%#Container.DataItem.Item("FullName")%> /> 
                      </template>  
 
                      <template name="separatortemplate">   
                        <font face="Verdana" style="font-size:8pt"><nobr>---></nobr> 
                      </template>
                    </asp:DataList>  
                               
                    <p>
      
                    <asp:DataList MaintainState="false" id="Interface1" runat=server style="margin-left:10" RepeatDirection="horizontal"
                       RepeatLayout="Flow"  width="100%">
                                     
                      <template name="headertemplate">
                        <font size=2><b> Implements </b></font> <br>
                      </template> 

                      <template name="itemtemplate">   
                        <asp:HyperLink runat=server NavigateUrl=<%# GetURL(Container.DataItem) %> text=<%#Container.DataItem.Item("FullName")%> /> 
                      </template>  
          
                      <template name="separatortemplate">
                        <font face="Verdana" style="font-size:8pt">,
                      </template> 

                    </asp:DataList>           

                    <p>
  
                    <asp:DataList MaintainState="false" id="SubClasses" style="margin-left:10" runat=server
                       RepeatLayout="Flow" RepeatDirection="horizontal"  width="100%">
                      <template name="headertemplate">
                        <font size=2> <b>Subclassed By </b></font>  <br>
                      </template>  

                      <template name="itemtemplate">   
                        <asp:HyperLink runat=server NavigateUrl=<%# GetURL(Container.DataItem) %> text=<%#Container.DataItem.Item("FullName")%> /> 
                      </template>  

                      <template name="separatortemplate">
                        <font face="Verdana" style="font-size:8pt">,
                      </template> 
                    </asp:DataList>
                               
                    <p>
                     
                  </td>
                </tr>
              </table>

            </td>
          </tr>
        </table>
    </form>
  </body>
</html>	
	         
</xmp>
        <span id="ErrorMessage" style="color:red"></span>

    </form>
