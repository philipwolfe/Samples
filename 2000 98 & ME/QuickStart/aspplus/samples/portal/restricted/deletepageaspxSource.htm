



    <link rel="stylesheet" href="../../../../util/style.css">

    <form name="Form" method="post" action="srcview.htm?path=/QuickStart/aspplus/samples/portal/portal.src&file=restricted/deletepage.htm" id="Form">
<input type="hidden" name="__VIEWSTATE" value="YTB6MTQ3MzAyNjM4MF9hMHpfaHo1ejN4X2Ewel9oejV6MHhfYTB6aHppbm5lcmh0bWxfcmVzdHJpY3RlZC9kZWxldGVwYWdlLmFzcFx4eF9feHhfeHhfeF9feA==0d3e60e0" />


        <div class="SampleHeader" style="width:100%">
            <div class="SampleTitle">
                <span id="Title">restricted/deletepage.htm</span>
            </div>
            <table id="SourceTable" style="font: 8pt Verdana">
    <tr>
        <td style="padding-right:10;"><b><nobr>Unrestricted Pages</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/defaultaspxsource.htm'>default.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/loginaspxsource.htm'>login.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/useraspxsource.htm'>user.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/congratsaspxsource.htm'>congrats.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/constraspxsource.htm'>constr.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/configwebsource.htm'>config.web</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>Restricted Pages</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/restricted/customizeaspxsource.htm'>restricted/customize.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/restricted/deletepageaspxsource.htm'>restricted/deletepage.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/restricted/layoutaspxsource.htm'>restricted/layout.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/restricted/optionsaspxsource.htm'>restricted/options.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/restricted/configwebsource.htm'>restricted/config.web</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>Personalization Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/personalization/personalizationcssource.htm'>personalization/Personalization.cs</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/personalization/portalmodulecssource.htm'>personalization/PortalModule.cs</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/personalization/makesamplebatsource.htm'>personalization/makesample.bat</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>Stored Procedures</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/data/portalsqlsource.htm'>data/portal.sql</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>Login Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/modules/login/loginascxsource.htm'>modules/login/login.ascx</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>BookOfTheDay Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/modules/bookoftheday/bookofthedayascxsource.htm'>modules/bookoftheday/bookoftheday.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/bookoftheday/bookoftheday_demoaspxsource.htm'>modules/bookoftheday/bookoftheday_demo.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>SiteDirectory Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/modules/sitedirectory/sitedirectoryascxsource.htm'>modules/sitedirectory/sitedirectory.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/sitedirectory/sitedirectory_demoaspxsource.htm'>modules/sitedirectory/sitedirectory_demo.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/sitedirectory/sitedirectory_editaspxsource.htm'>modules/sitedirectory/sitedirectory_edit.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>Welcome Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/modules/welcome/welcomeascxsource.htm'>modules/welcome/welcome.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/welcome/welcome_demoaspxsource.htm'>modules/welcome/welcome_demo.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>LocalNews Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/modules/static/localnewsascxsource.htm'>modules/static/localnews.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/static/localnews_demoaspxsource.htm'>modules/static/localnews_demo.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>WorldNews Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/modules/static/worldnewsascxsource.htm'>modules/static/worldnews.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/static/worldnews_demoaspxsource.htm'>modules/static/worldnews_demo.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>Weather Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/modules/static/weatherascxsource.htm'>modules/static/weather.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/static/weather_demoaspxsource.htm'>modules/static/weather_demo.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>FavoriteLinks Module</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/modules/favoritelinks/favoritelinksascxsource.htm'>modules/favoritelinks/favoritelinks.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/favoritelinks/favoritelinks_demoaspxsource.htm'>modules/favoritelinks/favoritelinks_demo.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/favoritelinks/favoritelinks_editaspxsource.htm'>modules/favoritelinks/favoritelinks_edit.htm</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/favoritelinks/favoritelinksleftascxsource.htm'>modules/favoritelinks/favoritelinksleft.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/modules/favoritelinks/favoritelinksleft_demoaspxsource.htm'>modules/favoritelinks/favoritelinksleft_demo.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b><nobr>Include Files</nobr>: </b></td>
        <td><a href='../../../../aspplus/samples/portal/include/editmoduleheaderascxsource.htm'>include/editmoduleheader.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/editmodulefooterascxsource.htm'>include/editmodulefooter.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/leftmoduleheaderascxsource.htm'>include/leftmoduleheader.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/leftmodulefooterascxsource.htm'>include/leftmodulefooter.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/pageheaderascxsource.htm'>include/pageheader.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/leftmoduleheaderascxsource.htm'>include/leftmoduleheader.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/leftmodulefooterascxsource.htm'>include/leftmodulefooter.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/rightmoduleheaderascxsource.htm'>include/rightmoduleheader.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/rightmodulefooterascxsource.htm'>include/rightmodulefooter.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/pagefooterascxsource.htm'>include/pagefooter.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/pagesubheaderascxsource.htm'>include/pagesubheader.ascx</a> &nbsp;&nbsp<a href='../../../../aspplus/samples/portal/include/pagesubfooterascxsource.htm'>include/pagesubfooter.ascx</a> &nbsp;&nbsp</td>
    </tr>
</table>

        </div>

        <xmp><%@ Page Description="Delete Page" Inherits="PortalModulePage" %>

<%@ Register TagPrefix="Portal" TagName="PageHeader" Src="../../../../aspplus/samples/portal/include/pageheader.ascx" %>
 
<html>
<head>

    <script language="C#" runat="server">

        public String pageName;
        public int pageIndex;
        public String [] pageList;

        protected void Page_Load(Object sender, EventArgs e)
        {
            pageIndex = Int32.Parse(Request.Cookies["_PageIndex"].Value);

            String pageNames = UserState["PageNames"];
            pageList = pageNames.Split(new char[] { ';' });
            pageName = pageList[pageIndex];
        }
        
        public void Submit_Click(Object sender, EventArgs evt) 
        {
            String s = "";
            for (int i=0; i<pageList.Length; i++)
            {
                if (i != pageIndex)
                {
                    s += pageList[i] + ";";
                }
            }
            char[] semi = {';'};

            // Note: if we increase page max, need to modify also this

            UserState["PageModules_" + pageIndex + "L"] = "";
            UserState["PageModules_" + pageIndex + "R"] = "";

            if (pageIndex == 1) { 
                UserState["PageModules_1L"] = UserState["PageModules_2L"];
                UserState["PageModules_1R"] = UserState["PageModules_2R"];
                UserState["PageModules_2L"] = "";
                UserState["PageModules_2R"] = "";
            }

            UserState["PageNames"] = s.TrimEnd(semi);

            HttpCookie PageIndex = new HttpCookie("_PageIndex", "0");
            PageIndex.Path = "/";
            PageIndex.Expires = new DateTime(2002, 10, 10);
            Response.AppendCookie(PageIndex);

            Response.Redirect("/quickstart/aspplus/samples/portal/default.htm"); 
        }

        public void Cancel_Click(Object sender, EventArgs evt) 
        {
            Response.Redirect("/quickstart/aspplus/samples/portal/default.htm");
            
        }

    </script>

</head>
<body bgcolor="ffffff" style="margin:0,0,0,0">

<Portal:PageHeader ShowSignOut="false" runat="server"/>

<table border=0 width="100%" cellspacing=0 cellpadding=0 >
    <tr>
        <td align=left bgcolor="<%=UserState["HeadColor"]%>" width="100%">
            <table bgcolor="<%=UserState["HeadColor"]%>" border=0 width="100%" cellspacing=0 cellpadding=2>
                <tr align=left>
                    <td bgcolor="<%=UserState["HeadColor"]%>" height="35" style="padding:0,0,0,15;border-color:black;border-style:solid; border-width:1;border-right:0;border-left:0;"><font face=Arial color="white">&nbsp;<b>Confirm Delete</b></font>&nbsp;</td>
                </tr>
                <tr align=left bgcolor="<%=UserState["SubheadColor"]%>">
                    <td style="padding:10,0,10,20;border-color:black;border-style:solid; border-width:1;border-right:0;border-left:0;border-top:0"><font face="Arial"><b>Are you sure you want to delete "<%=pageName%>"?</b></font></td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<table border=0 width="100%" cellspacing=0 cellpadding=0 style="padding:0,0,0,0">

    <tr>
        <td width="1%" valign="top">
            <table border=0 width="100%" cellspacing=5 cellpadding=0 style="padding:5,0,0,0">
                <tr>
                  <td width="200">
                  </td>
                </tr>
            </table>
        </td>
        <td width="99%" valign="top">
            <table border=0 width="100%" cellspacing=10 cellpadding=0>
                <tr>
                  <td>
                    <!--BEGIN MODULE-->
                    <table width="100%" cellpadding=5 cellspacing=0 border=0>
                      <tr bgcolor="ffffff">
                        <td align="left">
                           <font face="Arial" size="-1">
                               <form runat="server">  
                                   <input type="submit" OnServerClick="Submit_Click" value="Delete Page" runat="server"/>
                                   <input type="reset" OnServerClick="Cancel_Click" value="Cancel" runat="server"/>
                               </form> 
                           </font>
                        </td>
                      </tr>
                    </table>
                    <!--END MODULE-->
                  </td>
                </tr>
            </table>
        </td>
    </tr>

</table>
</body>
</html>
</xmp>
        <span id="ErrorMessage" style="color:red"></span>

    </form>
