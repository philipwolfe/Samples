



    <link rel="stylesheet" href="../../../../../util/style.css">

    <form name="Form" method="post" action="srcview.htm?path=/QuickStart/aspplus/samples/webforms/data/xmlgen.src&file=VB/xmlgen.htm" id="Form">
<input type="hidden" name="__VIEWSTATE" value="YTB6MTQ3MzAyNjM4MF9hMHpfaHo1ejN4X2Ewel9oejV6MHhfYTB6aHppbm5lcmh0bWxfVkIvXHhtbGdlbi5hc3BceHhfX3h4X3h4X3hfX3g=9efd9335" />


        <div class="SampleHeader" style="width:100%">
            <div class="SampleTitle">
                <span id="Title">VB/xmlgen.htm</span>
            </div>
            <table id="SourceTable" style="font: 8pt Verdana">
    <tr>
        <td style="padding-right:10;"><b>C# Source: </b></td>
        <td><a href='../../../../../aspplus/samples/webforms/data/xmlgenaspxsource.htm'>xmlgen.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b>VB Source: </b></td>
        <td><a href='../../../../../aspplus/samples/webforms/data/vb/xmlgenaspxsource.htm'>VB/xmlgen.htm</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b>JScript Source: </b></td>
        <td><a href='../../../../../aspplus/samples/webforms/data/js/xmlgenaspxsource.htm'>JS/xmlgen.htm</a> &nbsp;&nbsp</td>
    </tr>
</table>

        </div>

        <xmp><%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.Data.SQL" %>

<html>
<head>

    <script language="VB" runat="server">

        Public Source As DataView
        Public DS As DataSet
        Public GetSchemaChecked, GetDataChecked As Boolean

        Sub Submit_Click(Sender As Object, Evt As EventArgs)

            If (Page.IsPostBack)

                Dim MyConnection As SQLConnection
                Dim MyCommand As SQLDataSetCommand

                MyConnection = New SQLConnection(ConnectString.Value)
                MyCommand = New SQLDataSetCommand(MyText.Value, MyConnection)

                DS = New DataSet()
                MyCommand.FillDataSet(DS, "Table")

                Source = New DataView(DS.Tables(0))

                GetSchemaChecked = GetSchema.Checked
                GetDataChecked = GetData.Checked

                MyDataGrid.DataSource=Source
                MyDataGrid.DataBind()
            End If
         End Sub

    </script>

</head>
<body bgcolor="ffffcc">

    <h3><font face="Verdana">SQL to XML Generator</font></h3>

    <form runat="server">

        <table border=0 cellpadding=5 style="font:10pt verdana">	
        <tr>
          <td colspan="2">
            <b>Connect String:</b><br>
            <input id="ConnectString" type="text" value="server=localhost;uid=sa;pwd=;database=pubs" size="85" runat="server">
          </td>
        </tr>
        <tr>
          <td colspan="2">
            <b>Query:</b><br>
            <input id="myText" type="text" value="select * from Authors" size="85" runat="server">
          </td>
        </tr>
        <tr>
          <td>
            <input type="radio" id="GetSchema" name="Mode" runat="server"/>Get XML Schema<br>
            <input type="radio" id="GetData" name="Mode" runat="server"/>Get XML Data<br>
            <input type="radio" id="GetBoth" name="Mode" checked runat="server"/>Get Both
          </td>
          <td valign="top">
            <input type="submit" runat="server" OnServerClick="Submit_Click">
          </td>
        </tr>
        <tr>
          <td colspan="2">

              <%  If Page.IsPostBack  %>
                  <b>Result:</b><br>
                  <textarea cols=80 rows=25>
              <%
                  If GetSchemaChecked
                      DS.WriteXmlSchema(Response.Output)
                  Else If GetDataChecked
                      DS.WriteXmlData(Response.Output)
                  Else
                      DS.WriteXml(Response.Output)
                  End If
              %>
                  </textarea>
              <%  End If  %>

          </td>
        </tr>
        <tr>
          <td colspan="2">

              <%  If (Page.IsPostBack)  %>
                  <b>Data:</b><br>
              <%  End If  %>

              <ASP:DataGrid id="MyDataGrid" 
                BackColor="#EDBE7B" 
                BorderColor="black"
                ShowFooter="false" 
                CellPadding=3 
                CellSpacing="0"
                Font-Name="Verdana"
                Font-Size="8pt"
                HeaderStyle-BackColor="#DC6035"
                MaintainState="false"
                runat="server"
              />

          </td>
        <tr>
        </table>

    </form>

</body>
</html>

</xmp>
        <span id="ErrorMessage" style="color:red"></span>

    </form>
