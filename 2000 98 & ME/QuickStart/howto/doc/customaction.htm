

<!--BEGIN HEADER-->
<html>
<head>
<link rel="stylesheet" href="../../include/qsstyle.css">
</head>
<body topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" >

<table class="outer" cellpadding=0 cellspacing=0>
<tr>
<td class="toc" valign="top" width="210">

<table>
<tr>
<td nowrap style="padding-right:15">

<div class="toc" style="font-size:8pt;color:darkred;">

    <div style="padding:0,0,4,0"><b>Setup</b><br></div>
    &nbsp; <a class="outer" href="../../howto/doc/installers.htm">Create system resources</a><br>
    &nbsp; <a class="outer" href="../../howto/doc/customaction.htm">Execute custom setup code</a><p>
    <div style="padding:0,0,4,0"><a target="_top" style="color:darkred" href="../../howto"><b>Back to Index</b></a><br></div>

</div>

</td>
</tr>
</table>






</td>
<td valign="top">
<div class="body">
<!--END HEADER-->

<style>
.mydd {  font: smaller verdana; }
.code1 {
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	background:#DFDFDF;
	font-family:"Courier New";
	color:blue;
	}
.codecomment1 {
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	background:#DFDFDF;
	font-family:"Courier New";
	color:green;
	}
.issue {
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	background-color:RED;
	color:WHITE;
	font-weight:bold;
	}


body { font: smaller verdana }        

</style>





<h4>How Do I...Execute Custom Code During Installation?</h4>

An application may consist not only of the
traditional program files, but also of associated resources, such as message
queues, event logs, and performance counters, that must be created on the
deployment destination. You can configure your application to create these
resources when you application is installed and to remove them if your
application is uninstalled, using what are called <span class="Italic">installation
components</span>. Sometimes you may wish to run custom code during the
installation and uninstallation process.

<p>This sample illustrates how to build an
application which will run custom code when installed or uninstalled.</p>

<p>Run the following command line to install
the system resources:</p>

<div class="code"><pre>
&gt; InstallUtil.exe CustomAction.exe
</pre></div>

<p>Note that the message &quot;Installing: Any code could be executed here!&quot;
message is printed to the console. You can substitute the line which
prints the message (see CustomInstaller.cs file) for any custom code you want to
be executed during installation process.</p>

<p>You can execute different custom code while
uninstalling:</p>

<div class="code"><pre>
&gt; InstallUtil.exe /u CustomAction.exe
</pre></div>

<h4>Example</h4>

<span>
  
  

       

<div class="indent">



	<a target="_blank" href="../../howto/samples/services/installers/customaction/vb">
	<img style="border-color:black" border=1 src="../../images/console.gif"><br>
	</a>
	<div class="caption">CustomAction.exe</div><br>
	
	
		[<a target="_blank" href="../../howto/samples/services/installers/customaction/vb">Run Sample</a>] | 
		[<a target="_blank" href="../../howto/samples/services/installers/customaction/customactioncssource.htm">View Source</a>]
	
	
	</div>


  </span>

</div>


<!--END FOOTER-->
<p>
<hr>
<p>
</div>
</td>
</tr>
</table>
</BODY>
</html>
<!--END FOOTER-->