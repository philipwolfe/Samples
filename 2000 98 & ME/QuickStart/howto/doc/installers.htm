

<!--BEGIN HEADER-->
<html>
<head>
<link rel="stylesheet" href="../../include/qsstyle.css">
</head>
<body topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" >

<table class="outer" cellpadding=0 cellspacing=0>
<tr>
<td class="toc" valign="top" width="210">

<table>
<tr>
<td nowrap style="padding-right:15">

<div class="toc" style="font-size:8pt;color:darkred;">

    <div style="padding:0,0,4,0"><b>Setup</b><br></div>
    &nbsp; <a class="outer" href="../../howto/doc/installers.htm">Create system resources</a><br>
    &nbsp; <a class="outer" href="../../howto/doc/customaction.htm">Execute custom setup code</a><p>
    <div style="padding:0,0,4,0"><a target="_top" style="color:darkred" href="../../howto"><b>Back to Index</b></a><br></div>

</div>

</td>
</tr>
</table>






</td>
<td valign="top">
<div class="body">
<!--END HEADER-->

<style>
.mydd {  font: smaller verdana; }
.code1 {
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	background:#DFDFDF;
	font-family:"Courier New";
	color:blue;
	}
.codecomment1 {
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	background:#DFDFDF;
	font-family:"Courier New";
	color:green;
	}
.issue {
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	background-color:RED;
	color:WHITE;
	font-weight:bold;
	}


body { font: smaller verdana }        

</style>





<h4>How Do I...Create system resources during installation?</h4>

<p>An application may consist not only of 
traditional program files, but also of associated resources, such as message
queues, event logs, and performance counters, that must be created on the
deployment destination. You can configure your application to create these
resources when you application is installed and to remove them if your
application is uninstalled, using what are called <i>installation
components</i>.</p>

<p>This sample illustrates how to build an
application which will set up its own message queue and its own event log
during installation and delete those two system resources when the application
is uninstalled. To run the sample you need to have message queueing installed 
on your machine. You can install message queueing from Start-> Settings-> 
Control&nbsp;Panel-> Add/Remove&nbsp;Programs-> Add/Remove&nbsp;System&nbsp;Components.
</p>

<p>Run the following command line to install the system resources:</p>

<div class="code"><pre>
&gt; InstallUtil.exe Installers.exe
</pre></div>

<p>Now, you can verify in the message queueing
management console that an &quot;InstallersSample&quot; message queue was
installed. Also, an &quot;InstallersSample&quot; event log source was set up in
the registry.</p>

<p>To uninstall the message queue and the event
log source, Run the following command:</p>

<div class="code"><pre>
&gt;InstallUtil.exe /u Installers.exe
</pre></div>

<p>How does it work? The InstallUtil.exe will
search, using Reflection mechanism, all assemblies passed as the command line
arguments for classes inheriting from Installer class and with
RunInstallerAttribute set to true. The Installers then handle the install and
uninstall actions.&nbsp;</p>

<h4>Example</h4>

<span>
  
  

        

<div class="indent">



	<a target="_blank" href="../../howto/samples/services/installers/installers/vb">
	<img style="border-color:black" border=1 src="../../images/console.gif"><br>
	</a>
	<div class="caption">Installers.exe</div><br>
	
	
		[<a target="_blank" href="../../howto/samples/services/installers/installers/vb">Run Sample</a>] | 
		[<a target="_blank" href="../../howto/samples/services/installers/installers/installerscssource.htm">View Source</a>]
	
	
	</div>


  </span>

<!--END FOOTER-->
<p>
<hr>
<p>
</div>
</td>
</tr>
</table>
</BODY>
</html>
<!--END FOOTER-->