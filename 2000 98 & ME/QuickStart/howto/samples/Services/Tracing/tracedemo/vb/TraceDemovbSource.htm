



    <link rel="stylesheet" href="../../../../../../util/style.css">

    <form name="Form" method="post" action="srcview.htm?path=/QuickStart/howto/samples/Services/Tracing/tracedemo/tracedemo.src&file=VB%5CTraceDemo.vb" id="Form">
<input type="hidden" name="__VIEWSTATE" value="YTB6MTQ3MzAyNjM4MF9hMHpfaHo1ejN4X2Ewel9oejV6MHhfYTB6aHppbm5lcmh0bWxfVkJcXFRyYWNlRGVtby52YnhfX3h4X3h4X3hfX3g=20a34bad" />


        <div class="SampleHeader" style="width:100%">
            <div class="SampleTitle">
                <span id="Title">VB\TraceDemo.vb</span>
            </div>
            <table id="SourceTable" style="font: 8pt Verdana">
    <tr>
        <td style="padding-right:10;"><b>C# Source: </b></td>
        <td><a href='../../../../../../howto/samples/services/tracing/tracedemo/tracedemocssource.htm'>TraceDemo.cs</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b>VB Source: </b></td>
        <td><a href='../../../../../../howto/samples/services/tracing/tracedemo/vb/tracedemovbsource.htm'>VB\TraceDemo.vb</a> &nbsp;&nbsp</td>
    </tr>
</table>

        </div>

        <xmp>Imports System
Imports System.Diagnostics
Imports System.IO

' Set DWORD value of HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\COMPlus\Switches\TraceMethods to 0 (false) or 1 (true)
' Set DWORD value of HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\COMPlus\Switches\Arithmetic to 0 (off), 1(error), 2 (warning), 3(info)4(verbose)

public class TraceDemo
	shared traceMethods As BooleanSwitch 
	shared arithmeticSwitch As TraceSwitch

	public shared sub Main() 
		Debug.Listeners.Add(new TextWriterTraceListener(Console.Out))
		traceMethods = new BooleanSwitch("TraceMethods", "TraceDemo Method Tracing Switch")
		arithmeticSwitch = new TraceSwitch("Arithmetic","Arithemtic Operations")
		
		Dim a As Integer
		Dim b As Integer	
		for a = 0 to  4
			for b = 0 to 4
				Console.WriteLine(CStr(a)+"/"+CStr(b)+"="+CStr(Percent(a,b)))
			next b
		next a
	end sub

	public shared function Divide(a as Int64, b as Int64) As Int64
		if(traceMethods.Enabled) then 
			Trace.WriteLine("Divide("+CStr(a)+","+CStr(b)+") called") 
		end if
		
		if(b=0) then
			Trace.WriteLineIf(arithmeticSwitch.TraceWarning,"!!!!!!!!!!!!!!!!!!Division by 0!!!!!!!!!!!!!!!!")
			b = 1
		end if
		
		Dim ratio As Int64 = CType(a / b,Int64)
	
		if(traceMethods.Enabled) then 
			Trace.WriteLine("Divide("+CStr(a)+","+CStr(b)+") returns "+CStr(ratio))
		end if
		Divide = ratio
	end function

	public shared function Percent(a as Int64, b as Int64) as Int64
		if(traceMethods.Enabled) then 
			Trace.WriteLine("Percent("+CStr(a)+","+CStr(b)+") called")
		end if
		
		Dim percentResult As Int64 = CType(Divide(100*a, b),Int64)

		if(traceMethods.Enabled) then 
			Trace.WriteLine("Percent("+CStr(a)+","+CStr(b)+") returns "+CStr(percentResult))
		end if
		Percent = percentResult
	end function
end class
</xmp>
        <span id="ErrorMessage" style="color:red"></span>

    </form>
