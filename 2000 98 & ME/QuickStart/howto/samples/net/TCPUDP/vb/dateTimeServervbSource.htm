



    <link rel="stylesheet" href="../../../../../util/style.css">

    <form name="Form" method="post" action="srcview.htm?path=/QuickStart/howto/samples/net/TCPUDP/datetimeserver.src&file=VB/dateTimeServer.vb" id="Form">
<input type="hidden" name="__VIEWSTATE" value="YTB6MTQ3MzAyNjM4MF9hMHpfaHo1ejN4X2Ewel9oejV6MHhfYTB6aHppbm5lcmh0bWxfVkIvZGF0ZVRpbWVTZXJ2ZXIudmJ4X194eF94eF94X194d619bae5" />


        <div class="SampleHeader" style="width:100%">
            <div class="SampleTitle">
                <span id="Title">VB/dateTimeServer.vb</span>
            </div>
            <table id="SourceTable" style="font: 8pt Verdana">
    <tr>
        <td style="padding-right:10;"><b>C# Console Source: </b></td>
        <td><a href='../../../../../howto/samples/net/tcpudp/datetimeservercssource.htm'>dateTimeServer.cs</a> &nbsp;&nbsp</td>
    </tr>
    <tr>
        <td style="padding-right:10;"><b>VB Console Source: </b></td>
        <td><a href='../../../../../howto/samples/net/tcpudp/vb/datetimeservervbsource.htm'>VB/dateTimeServer.vb</a> &nbsp;&nbsp</td>
    </tr>
</table>

        </div>

        <xmp>Imports System
Imports System.Net
Imports System.Net.Sockets
Imports System.Text

Public Class DateTimeServer
    Public Shared Sub temp()
        System.Console.WriteLine("hello")
        Console.Writeline("Hello\n")
    End Sub
    
    Public Shared Sub Main()
        Dim now As Date
        Dim strDateLine As String
        Dim ASCII As Encoding = Encoding.ASCII
        
        Dim tcpl As New TCPListener(13) 'listen on port 13
        
        tcpl.Start()
        
        Console.WriteLine("Waiting for clients to connect")
        Console.WriteLine("Press Ctrl+c to Quit...")
        
        While (True)
            ' Accept will block until someone connects
            Dim s As Socket = tcpl.Accept()
            
            ' Get the current date and time then concatenate it
            ' into a string
            now = DateTime.Now
            strDateLine = now.ToShortDateString() + " " + now.ToLongTimeString()
            
            ' Convert the string to a Byte Array and send it
            Dim byteDateLine() As Byte = ASCII.GetBytes(strDateLine.ToCharArray())
            s.Send(byteDateLine, byteDateLine.Length, 0)
            Console.WriteLine("Sent " + strDateLine)
        End While
    End Sub
End Class
</xmp>
        <span id="ErrorMessage" style="color:red"></span>

    </form>
