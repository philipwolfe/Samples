<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./ReadMe_files/filelist.xml">
<title>Microsoft TerraService for </title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>tbarclay</o:Author>
  <o:LastAuthor>tbarclay</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2001-06-17T21:39:00Z</o:Created>
  <o:LastSaved>2001-06-17T21:39:00Z</o:LastSaved>
  <o:Pages>5</o:Pages>
  <o:Words>2132</o:Words>
  <o:Characters>12154</o:Characters>
  <o:Company>Microsoft</o:Company>
  <o:Lines>101</o:Lines>
  <o:Paragraphs>24</o:Paragraphs>
  <o:CharactersWithSpaces>14925</o:CharactersWithSpaces>
  <o:Version>9.4119</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:553679495 -2147483648 8 0 66047 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Tahoma;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	color:windowtext;
	mso-font-kerning:16.0pt;
	font-weight:bold;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	color:windowtext;
	font-weight:bold;
	font-style:italic;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
span.msoIns
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:underline;
	text-underline:single;
	color:teal;}
span.msoDel
	{mso-style-type:export-only;
	mso-style-name:"";
	text-decoration:line-through;
	color:red;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:188841806;
	mso-list-type:hybrid;
	mso-list-template-ids:1554291752 1852757540 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1
	{mso-list-id:691344602;
	mso-list-type:hybrid;
	mso-list-template-ids:839046258 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1>Microsoft TerraService for .NET Beta 2</h1>

<p class=MsoNormal>This document is the Release Notes for the Binary and Source
Code download of the Microsoft TerraService that demonstrates how to build a
SOAP/XML based web service using the Visual Studio .NET and the Microsoft .NET Framework
services.</p>

<p class=MsoNormal>The <a href="http://terraservice.net/">http://terraservice.net</a>
web site hosts three .NET Web Service applications – TerraService,
LandmarkService, and CensusService.<span style="mso-spacerun: yes"> 
</span>These web services are designed to help you learn how to program and use
web services in your own applications.<span style="mso-spacerun: yes"> 
</span>All the documentation and code required by your .NET programs is hosted
at the <a href="http://terraservice.net/">http://terraservice.net</a> web
site.<span style="mso-spacerun: yes">  </span>You are not required to host any
database system software or data on your system or network to access the web
services.</p>

<p class=MsoNormal>The goal of this download is to provide insight and clues to
how the web services at <a href="http://terraservice.net/">http://terraservice.net</a>
work.<span style="mso-spacerun: yes">  </span>The source code in the TerraServer
download directories is intended to be a teaching aid.</p>

<h2>Contents</h2>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>License
     Agreement</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>Overview
     of Microsoft TerraService</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>TerraDemo
     Windows Form demonstration program</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>TerraService
     web service source code</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>CensusService
     web service source code</li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'>CensusServer
     ASP.NET sample code</li>
</ul>

<h2>License Agreement</h2>

<p class=MsoNormal>The source and binary code you have downloaded and described
in this document is protected by an End User License Agreement, which you have
accepted in order to download this document.<span style="mso-spacerun: yes"> 
</span>The following is the license agreement you had read and accepted:</p>

<p class=MsoBodyText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></b></p>

<p class=MsoBodyText style='text-align:justify'><b style='mso-bidi-font-weight:
normal'><span style='font-family:Arial'>Microsoft TerraService V1.0.0.0 End
User License Agreement<o:p></o:p></span></b></p>

<p class=MsoBodyText style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText style='text-align:justify'><span style='font-family:Arial'>This
Microsoft Research Source Code License Agreement (&quot;MSR-SCLA&quot;) is a
legal agreement between you<b style='mso-bidi-font-weight:normal'><span
style='color:red'> </span></b>and Microsoft Corporation (“Microsoft” or “we”)
for the above pre-release Software. <o:p></o:p></span></p>

<p class=MsoBodyText style='text-align:justify'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoBodyText style='text-align:justify'><span style='font-family:Arial'>By
installing, copying, compiling or otherwise using the Software found at <a
href="http://research.microsoft.com/downloads/">http://research.microsoft.com/downloads/</a>,
you agree to be bound by the terms of this MSR-SCLA. If you do not agree, do
not install, copy, compile or use the Software. The Software is protected by
copyright and other intellectual property laws and is licensed, not sold.<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p style='text-align:justify'><span style='font-size:10.0pt;font-family:Arial'>You
may do anything you want with the Software for non-commercial research or teaching
purposes, free of charge. </span><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Arial;color:windowtext'>In return, we simply ask that you
agree to the following:<o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.25in;text-align:justify;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial'>To leave in place all
copyright notices and licensing information that you might find in the
Software.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in;text-align:justify;text-indent:
-.25in;mso-list:l0 level1 lfo2;mso-list-change:\F0B7 "Louis Carbonneau" 20000907T0950;
tab-stops:list .25in'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial'>To make freely
available to others the source code of any modifications or additions you make
to the Software source code, and any related documentation, solely and
exclusively under the same terms as this License.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in;text-align:justify;text-indent:
-.25in;mso-list:l0 level1 lfo2;tab-stops:list .25in;mso-layout-grid-align:none;
text-autospace:none'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial'>To grant back to
Microsoft a non-exclusive, royalty free right to use, further modify and
distribute, free of any additional restrictions or obligations, your
modifications or additions in future versions of the Software, or in
combination with any other software, hardware or service.</span><i><span
style='mso-bidi-font-size:11.0pt;font-family:Arial'> </span></i><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in;text-align:justify;text-indent:
-.25in;mso-list:l0 level1 lfo2;tab-stops:list .25in;mso-layout-grid-align:none;
text-autospace:none'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial'>That you will not use
the Software in a live operating environment where it may be relied upon to
perform in the same manner as a commercially released product, or with data
that has not been sufficiently backed up.<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:.25in;text-align:justify;text-indent:
-.25in;mso-list:l0 level1 lfo2;tab-stops:list .25in;mso-layout-grid-align:none;
text-autospace:none'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-family:Arial'>That any feedback about
the Software provided by you to us is voluntarily given, and Microsoft shall be
free to use the feedback as it sees fit without obligation or restriction of
any kind, even if the feedback is designated by you as confidential.<o:p></o:p></span></p>

<p style='margin-top:6.0pt;margin-right:0in;margin-bottom:0in;margin-left:.25in;
margin-bottom:.0001pt;text-align:justify;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-bidi-font-family:Arial'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><b style='mso-bidi-font-weight:normal'><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Arial'>NO
WARRANTIES WHATSOEVER:</span></b><span style='font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:Arial'><span style="mso-spacerun: yes">  </span>That the
Software comes “AS IS”, with all faults and with no warranties, conditions or
representations. None. Not even the implied warranty of merchantability,
warranty of fitness for a particular purpose, or any warranty against
interference with your enjoyment of the Software or against infringement.<span
style="mso-spacerun: yes">  </span>The entire risk as to satisfactory quality,
performance, accuracy, and effort is with you.<span style="mso-spacerun: yes"> 
</span>There is no warranty that this Software will fulfill any of your
particular purposes or needs.<o:p></o:p></span></p>

<p style='margin-top:6.0pt;margin-right:0in;margin-bottom:0in;margin-left:.25in;
margin-bottom:.0001pt;text-align:justify;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-bidi-font-family:Arial'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Arial'>That we have no duty of reasonable care or lack of
negligence and that we are not obligated to (and will not) provide technical
support or updates for the Software. <o:p></o:p></span></p>

<p style='margin-top:6.0pt;margin-right:0in;margin-bottom:0in;margin-left:.25in;
margin-bottom:.0001pt;text-align:justify;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-bidi-font-family:Arial'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Arial'>That we will not be liable for any damages, including those
known as direct, indirect, special, consequential, or incidental damages
related to the Software or this MSR-SCLA, nor any damages for negligence, to
the maximum extent the law permits.<o:p></o:p></span></p>

<p style='margin-top:6.0pt;margin-right:0in;margin-bottom:0in;margin-left:.25in;
margin-bottom:.0001pt;text-align:justify;text-indent:-.25in;mso-list:l0 level1 lfo2;
tab-stops:list .25in'><![if !supportLists]><span style='font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:Symbol;mso-bidi-font-family:Arial'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Arial'>That if you sue or threaten to sue anyone over patents that
you think may apply to the Software or if you breach this MSR-SCLA in any way,
your license to the Software ends automatically. <o:p></o:p></span></p>

<p style='margin-top:6.0pt;margin-right:0in;margin-bottom:0in;margin-left:.25in;
margin-bottom:.0001pt;text-align:justify;text-indent:-.25in;mso-list:l0 level1 lfo2;
mso-list-change:\F0B7 meganca 20010328T1159;tab-stops:list .25in'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:Arial'>That this MSR-SCLA shall be construed and controlled by the
laws of the State of Washington, USA, without regard to conflicts of law. <o:p></o:p></span></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h2>Microsoft TerraService Overview</h2>

<p class=MsoNormal>The Microsoft TerraService is a web service implemented
using Microsoft .NET Framework and Visual Studio .NET technologies.<span
style="mso-spacerun: yes">  </span>The <a href="http://terraservice.net/">http://terraservice.net</a>
is the web address for all three web services – TerraService, LandmarkService,
and CensusService.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal>The TerraService web service hosts a set of web methods that
search and retrieve meta and image data contained in the Microsoft TerraServer
database.<span style="mso-spacerun: yes">  </span>The Microsoft TerraServer
database contains aerial imagery and scanned topographic maps provided by the
United States Geological Survey.<span style="mso-spacerun: yes">  </span>Image
data is stored within the database in the form of small, 200 by 200 pixel
compressed images in the Jpeg or GIF format.<span style="mso-spacerun: yes"> 
</span>The compressed images, dubbed “tiles”, can be lined up in an HTML-like
table to create the illusion of a single image. </p>

<p class=MsoNormal>The majority of the TerraService web methods return data
structures that describe virtual “tables” required to produce a single image of
some geographic region on the earth.<span style="mso-spacerun: yes">  
</span>Web methods exist to query by constant window size, a geographic area,
or by place name.<span style="mso-spacerun: yes">  </span>The TerraServer
database contains over 1.5 million common place names in the world.</p>

<p class=MsoNormal>The Web Forms at <a href="http://terraservice.net/">http://terraservice.net</a>
demonstrate how to call the TerraService web methods.<span style="mso-spacerun:
yes">  </span>The “Find Place:” form on the main page invokes the Find.aspx Web
Form which calls the GetPlaceList TerraService web method.<span
style="mso-spacerun: yes">   </span>The Map.aspx Web Form page calls
GetAreaFromPt TerraService web method to obtain the TerraServer tile meta-data
for a specific geographic point to produce a image at a user defined
resolution, width, and height.</p>

<p class=MsoNormal>The LandmarkService is a companion web service to the
TerraService.<span style="mso-spacerun: yes">  </span>The LandmarkServer
database contains over 800,000 named points such as schools, hospitals,
cemeteries, golf courses, etc.<span style="mso-spacerun: yes">  </span>The web
service methods in the LandmarkService are intended to be used along with the
TerraService web methods.<span style="mso-spacerun: yes">  </span>The Map.aspx
Web Form demonstrates this when the user selects an item in the Landmark
drop-down list.<span style="mso-spacerun: yes">  </span>The Web Form calls the
GetLandmarkPointsByRect method to obtain a list of the user requested landmarks
that are in the same geographic area covered by an image.</p>

<p class=MsoNormal>Finally, the <a href="http://terraservice.net/">http://terraservice.net</a>
web site hosts a third web service called the CensusService.<span
style="mso-spacerun: yes">  </span>The CensusService is intended to be the
“start here first” web service.<span style="mso-spacerun: yes">   </span>The
CensusService web service is much simpler to understand and use for web service
novices because it only contains tabular data, and the data is structured in a
simple hierarchical fashion.<span style="mso-spacerun: yes">  </span>Thus, we
think you’ll find it much easier to initially program and use than the
TerraService and LandmarkService which requires a bit of GDI programming in
order to render images containing the results of the queries.</p>

<p class=MsoNormal>The software in this download is provided to aid you in
learning how to program web services using the .NET Framework and Visual Studio
.NET.<span style="mso-spacerun: yes">  </span>The TerraDemo program is a
Windows Form application that calls the TerraService and LandmarkService web
services at <a href="http://terraservice.net/">http://terraservice.net</a>.<span
style="mso-spacerun: yes">  </span>It is intended to show you how to use the
web service methods along with all the tools available to .NET Framework and
VS.NET programmers to build a fairly sophisticated dynamic mapping
application.<span style="mso-spacerun: yes">   </span>The VS.NET project and
build files are available so you can build, debug, and test the program on your
computer system.</p>

<p class=MsoNormal>The TerraService and CensusService directories contain the
C# source code from the actual web service implementations hosted at <a
href="http://terraservice.net/">http://terraservice.net</a>.<span
style="mso-spacerun: yes">  </span>The VS.NET project files to build an run the
web service is not provided because you cannot host the web service without
access to the TerraServer and Census database server.<span style="mso-spacerun:
yes">  </span>This code is provided to give you an idea of how to implement
your own web services using C#, ADO.NET, and SQL Server.</p>

<p class=MsoNormal>The CensusWebForm directory contains the ASP.NET Web Form
code that implements the Census demonstration application at <a
href="http://terraservice.net/">http://terraservice.net</a>.<span
style="mso-spacerun: yes">  </span>This code is a very basic implementation
designed to show how to call a web service method from a web form.</p>

<p class=MsoNormal>The sub-sections below discuss the contents of each
directory in further detail.</p>

<h2>TerraDemo Windows Form Demonstration Program</h2>

<p class=MsoNormal>The sub-directory TerraDemo, contains the C Sharp source code
and binary program which accesses the Microsoft TerraService web service
located at <a href="http://terraservice.net/">http://terraservice.net</a>.<span
style="mso-spacerun: yes">  </span>This program is intended to be a learning
tool to demonstrate how to use C Sharp and Windows Form technologies to access
a web service. </p>

<p class=MsoNormal>To run the TerraDemo program, open the file
TerraDemo/Bin/Release/TerraDemo.exe.<span style="mso-spacerun: yes"> 
</span>This will launch the TerraDemo.exe program.<span style="mso-spacerun:
yes">  </span>Note, your system must have a connection to the Internet and you
must be able to access the <a href="http://terraservice.net/terraservice.asmx">http://terraservice.net/terraservice.asmx</a>
file in order to successfully run the terraDemo.exe program.</p>

<p class=MsoNormal>Often the best way to learn how to program a new technology
is to debug an existing program.<span style="mso-spacerun: yes">  </span>The
source code to TerraDemo is provided for exactly this purpose, to learn how to
program a .NET web service using Visual Studio .NET and the C Sharp
language.<span style="mso-spacerun: yes">  </span>To debug the TerraDemo
program, install the Beta 2 Visual Studio .NET software.<span
style="mso-spacerun: yes">  </span>Run Visual Studio .NET and open the
TerraDemo.sln file located in the TerraDemo directory.<span
style="mso-spacerun: yes">  </span>Select the Debug configuration.<span
style="mso-spacerun: yes">  </span>Select the Build.Rebuild All menu item to
build the program on your machine.<span style="mso-spacerun: yes">  </span>Now
you can set breakpoints in the application code and see how to access a .NET
web service from a Windows Form application.</p>

<h2>TerraService Web Service Source Code</h2>

<p class=MsoNormal>The directory TerraServer contains the source code to the
TerraService web service hosted at <a href="http://terraservice.net/">http://terraservice.net</a>.
<span style="mso-spacerun: yes"> </span>The source files are written in the C
Sharp language.<span style="mso-spacerun: yes">  </span>The
TerraService.asmx.cs file contains the public web methods that are described
and implemented by the <a href="http://terraservice.net/terraservice.asmx">http://terraservice.net/terraservice.asmx</a>
web service.<span style="mso-spacerun: yes">  </span>Note, the Visual Studio
files to build the application are not provided because the web service code
accesses and depends on the TerraServer SQL database which is not distributed
as part of this download.<span style="mso-spacerun: yes">  </span>Thus, you
cannot build an run the TerraService web service class on your system.</p>

<p class=MsoNormal>The source code to the TerraService web service is provided
to demonstrate how to build web service that accesses a SQL Server relational
database.<span style="mso-spacerun: yes">  </span>This web service demonstrates
how to use the ADO.NET classes to access the SQL Server database.<span
style="mso-spacerun: yes">   </span>Most TerraService web methods open a
connection to the TerraServer database, execute a stored procedure, and iterate
over the one-to-many row sets that are returned by the stored procedure.<span
style="mso-spacerun: yes">  </span>All TerraService web methods return a C#
struct or an array of C# structs.<span style="mso-spacerun: yes">  </span>Thus,
the code copies the data from the ADO.NET row set to C# struct fields. </p>

<p class=MsoNormal>Note, C# structs are not the only way to return data from a
web service.<span style="mso-spacerun: yes">  </span>Datasets can be returned
directly.<span style="mso-spacerun: yes">  </span>However, we made an
architectural decision to only use structs and arrays of structs in the
TerraService web service.</p>

<h2>CensusService Web Service</h2>

<p class=MsoNormal>The CensusServer directory contains the source code to the
CensusService web service located at <a href="http://terraservice.net/">http://terraservice.net</a>.<span
style="mso-spacerun: yes">  </span>The CensusService is designed to demonstrate
how a web service can present tabular data via web methods.<span
style="mso-spacerun: yes">  </span>It is intended to be a simple introduction
on how to build a web service that accesses a SQL Server database.<span
style="mso-spacerun: yes">  </span>Unlike TerraService and the LandmarkService,
there isn’t any imagery or geo-spatial data that requires special knowledge to
understand how to manipulate.<span style="mso-spacerun: yes">  </span></p>

<p class=MsoNormal>The CensusService database contains statistical facts on
states, counties, cities, and census tracts extracted from the 1990
Census.<span style="mso-spacerun: yes">  </span>The CensusService supports
simple methods that return one or more rows of statistical facts about specific
states, cities, counties, or census tracts.<span style="mso-spacerun: yes"> 
</span>The GetPoliticalUnitFactsByName web method returns a<span
style="mso-spacerun: yes">  </span>CensusFacts struct containing statistics for
named state, city, county, or census tract.<span style="mso-spacerun: yes"> 
</span></p>

<p class=MsoNormal>Like the TerraService and LandmarkService web services, the
CensusService is written in C#, returns data in C# struct or arrays of structs,
and uses ADO.NET to access a SQL Server database.<span style="mso-spacerun:
yes">  </span>The files to build the web service are not provided since the
database is not distributed with this download.</p>

<h2>CensusServer ASP.NET Sample Code</h2>

<p class=MsoNormal>The <a href="http://terraservice.net/">http://terraservice.net</a>
web site contains several HTML and ASP.NET Web Form files that demonstrate how
to use the CensusService web service in an ASP.NET Web Form application.<span
style="mso-spacerun: yes">  </span>These files are contained in the
CensusWebForm directory.<span style="mso-spacerun: yes">  </span>You can
compile and debug these files on your local system. </p>

<p class=MsoNormal>The CensusHome.htm file contains a simple HTML form that
calls a CensusService web method when the Go button is clicked.<span
style="mso-spacerun: yes">  </span>Clicking Go causes the CensusService web
method to return a C# struct in the form of a SOAP/XML document.<span
style="mso-spacerun: yes">  </span>The Internet Explorer web browser, version
5.5 and later, can display the SOAP/XML document.<span style="mso-spacerun:
yes">  </span>This demonstrates the simplest way, but not most elegant way, to
call a web service method.</p>

<p class=MsoNormal>The CensusHome.htm document also contains links to the
CensusDoc.htm document, the CensusSsample1.aspx Web Form document, and a link
to the CensusService.asmx web service document.</p>

<p class=MsoNormal>The CensusDoc.htm document describes the four web methods
implemented by the CensusService web service, the data returned by each method,
and the information required by each method.</p>

<p class=MsoNormal>The CensusSample1.aspx Web Form demonstrates how to call a
CensusService web service and then display the data returned by the web method
in an HTML table. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
