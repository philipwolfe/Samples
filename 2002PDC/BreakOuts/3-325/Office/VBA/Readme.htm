<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./Readme_files/filelist.xml">
<title>SAMPLE: Using NGWS Server from Excel 2000</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:LastAuthor>KONSTE</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>4</o:TotalTime>
  <o:Created>2000-06-27T02:57:00Z</o:Created>
  <o:LastSaved>2000-06-27T02:57:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>418</o:Words>
  <o:Characters>2386</o:Characters>
  <o:Company>Microsoft Corp.</o:Company>
  <o:Lines>19</o:Lines>
  <o:Paragraphs>4</o:Paragraphs>
  <o:CharactersWithSpaces>2930</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-alt:"\FF2D\FF33 \660E\671D";
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:0 0 0 0 0 0 0 0 0 0;
	mso-font-charset:128;
	mso-generic-font-family:roman;
	mso-font-format:other;
	mso-font-pitch:fixed;
	mso-font-signature:1 134676480 16 0 131072 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:Arial;
	mso-font-kerning:16.0pt;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:Arial;}
p.MsoNormalIndent, li.MsoNormalIndent, div.MsoNormalIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoList, li.MsoList, div.MsoList
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{mso-style-update:auto;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.25in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l1 level1 lfo1;
	tab-stops:list .25in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListBullet2, li.MsoListBullet2, div.MsoListBullet2
	{mso-style-update:auto;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	mso-pagination:widow-orphan;
	mso-list:l0 level1 lfo2;
	tab-stops:list .5in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListContinue, li.MsoListContinue, div.MsoListContinue
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoListContinue2, li.MsoListContinue2, div.MsoListContinue2
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Times New Roman";}
@page Section1
	{size:8.5in 11.0in;
	margin:56.7pt 65.95pt 56.7pt 65.95pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:-125;
	mso-list-type:simple;
	mso-list-template-ids:-1573478984;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet 2";
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1
	{mso-list-id:-119;
	mso-list-type:simple;
	mso-list-template-ids:-328034706;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-style-link:"List Bullet";
	mso-level-text:\F0B7;
	mso-level-tab-stop:.25in;
	mso-level-number-position:left;
	margin-left:.25in;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<h1><span style='mso-fareast-font-family:"MS Mincho"'>SAMPLE: Using NGWS Server
from Excel 2000<o:p></o:p></span></h1>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:3'>                                    </span><o:p></o:p></span></p>

<h2><span style='mso-fareast-font-family:"MS Mincho"'>OVERVIEW<o:p></o:p></span></h2>

<p class=MsoBodyTextIndent><span style='mso-fareast-font-family:"MS Mincho"'>Excel
is the spreadsheet component of Microsoft Office 2000. The purpose of this NGWS
Interoperability sample is to show how to prepare managed NGWS Server to be
used from the VBA based Excel macro. Server is written in C#.<o:p></o:p></span></p>

<h3><span style='mso-fareast-font-family:"MS Mincho"'>The sample shows the
following techniques:<o:p></o:p></span></h3>

<p class=MsoListBullet2><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Generation
of the signature file for the assembly<o:p></o:p></span></p>

<p class=MsoListBullet2><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Compilation
of the assembly and signing it with the key file<o:p></o:p></span></p>

<p class=MsoListBullet2><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Adding
the assembly to the local assemblies cache<o:p></o:p></span></p>

<p class=MsoListBullet2><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Registration
of the assembly in the classic COM manner to be used by the COM+ 1.0 clients<o:p></o:p></span></p>

<p class=MsoListBullet2><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Type
library export and registration<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:1'>            </span><o:p></o:p></span></p>

<h3><span style='mso-fareast-font-family:"MS Mincho"'>Managed Server shows:<o:p></o:p></span></h3>

<p class=MsoListBullet2><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Public
R/W property<o:p></o:p></span></p>

<p class=MsoListBullet2><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Method
returning single dimension array<o:p></o:p></span></p>

<p class=MsoListBullet2><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Method
returning two dimensional array<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:1'>            </span><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:1'>            </span><o:p></o:p></span></p>

<h2><span style='mso-fareast-font-family:"MS Mincho"'>HOW TO RUN THE SAMPLE:<o:p></o:p></span></h2>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Both
NGWS SDK and Office 2000 have to be properly installed to compile and run the
sample.<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Get
all the sample files to the empty directory<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>start
the Cmd.exe in this directory<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Run
cs.bat It will compile ExcelServer.cs component (see the detailed description
below)<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Open
Excel 2000. From its File-&gt;Open menu open Book1.xls. In case Excel warns you
about the macros in the workbook, Enable the macros, because it is the subject
of the sample.<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Go to
the menu Tools -&gt; Macro -&gt; Macros. Select MacroClient and press Edit
button. This will open VBA shell.<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>In
the VBA shell go to the menu Tools -&gt; References and verify that ExcelServer
component has a check mark at the left. When you create your own object to use
with VBA, after it is compiled and registered it must be referenced in VBA
shell by finding it in this list and putting a checkmark at the left of it.<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Close
the References VBA-Project dialog by clicking Ok button.<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Close
VBA shell and switch back to Excel application<o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Go to
the menu Tools -&gt; Macro -&gt; Macros. Select MacroClient and press Run
button. <o:p></o:p></span></p>

<p class=MsoListBullet><![if !supportLists]><span style='font-family:Symbol;
mso-fareast-font-family:"MS Mincho"'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-fareast-font-family:"MS Mincho"'>Mention
how MacroClient fills the worksheet with numbers, generated by ExcelServer.<o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-fareast-font-family:"MS Mincho"'><span
style='mso-tab-count:1'>            </span><o:p></o:p></span></p>

<h2><span style='mso-fareast-font-family:"MS Mincho"'>COMMENTS FOR CS.BAT<o:p></o:p></span></h2>

<p class=MsoBodyTextIndent><b><span style='mso-fareast-font-family:"MS Mincho"'>csc
/debug /t:library ExcelServer.cs /a.keyfile:Sample.key<o:p></o:p></span></b></p>

<p class=MsoBodyText><span style='mso-fareast-font-family:"MS Mincho"'>This
line invokes the compiler to create the assembly ExcelServer.dll and sign it
with the signature key file<o:p></o:p></span></p>

<p class=MsoBodyText><span style='mso-fareast-font-family:"MS Mincho"'>supplied.
If necessary another key file can be generated with the following command: sn
-k Sample.key<o:p></o:p></span></p>

<p class=MsoBodyTextIndent><b><span style='mso-fareast-font-family:"MS Mincho"'>al
/i:ExcelServer.dll<o:p></o:p></span></b></p>

<p class=MsoBodyText><span style='mso-fareast-font-family:"MS Mincho"'>This
line adds the newly generated assembly to the machine wide assemblies cache. If
this step is omitted the ExcelServer.dll must be present in the application
directory (in our case in the directory where Excel.exe resides), otherwise it
will not be found at runtime.<o:p></o:p></span></p>

<p class=MsoBodyTextIndent><b><span style='mso-fareast-font-family:"MS Mincho"'>regasm
ExcelServer.dll /tlb:ExcelServer.tlb<o:p></o:p></span></b></p>

<p class=MsoBodyText><span style='mso-fareast-font-family:"MS Mincho"'>This
line registers the ExcelServer.dll in the system registry, in order for it to
be visible in Excel shell among other References, available to connect.
Additionally it exports the type library ExcelServer.tlb and registers it with
the system, so that VBA can get info about the objects methods and properties.<o:p></o:p></span></p>

</div>

</body>

</html>
