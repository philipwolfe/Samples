<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Windows Installer Setup Log Analyzer</title>
</head>

<body>

<p align="left">
<b>Windows Installer Setup Log Analyzer Overview
</b><hr>
When given a setup log file for a Windows Installer based setup, the Windows Installer Setup Analyzer tool can be used to parse and analyze 
the log file.&nbsp; If errors are found in the log file, they will be displayed and possible solutions will be presented.&nbsp;
By default, non-critical errors are not displayed 
and only critical errors are shown.&nbsp; The tool also features report generation of the
analysis to text files for review and supports a quiet mode operation so you can
run the tool silently and collect the analysis results at a later time.<br><br><br>
<b>Windows Installer Verbose Log Analyzer Dialog</b>
<hr>
  The <b>Windows Installer Verbose Log Analyzer </b>dialog allows you to select a log file to parse.&nbsp;
The tool works best when working with verbose Windows Installer log files,
however, supports analyzing non-verbose logs as well.&nbsp; The <b> open</b> button opens the file in
<b>notepad</b>.&nbsp; The <b> preview</b> area on the dialog can be useful to you in making sure you are looking at the log file you want to analyze especially&nbsp;when you have a log file name that has a hard to read name like MSI123456.log.&nbsp;
The <b>analyze</b> button will parse the log file selection and display the
Detailed Log File View dialog.<br>
<br><br>
<b>Detailed Log File View Dialog</b>
<hr>
  The <b>Detailed Log File View</b> dialog will present to you useful information on the errors found and any solutions to the&nbsp;errors.&nbsp;
Since you may have
multiple errors in a setup, <b>Back</b> and <b>Next</b> buttons are provided.&nbsp;
By default, only the critical setup failure errors are shown.&nbsp; Non-critical errors can be shown by clicking the
<b>Show Ignored Debug Errors</b> checkbox.&nbsp; Other information such as the version of the Windows Installer engine that was on the failing machine is also shown.&nbsp;
If the installation was&nbsp;installed with elevated permissions, the <b>Elevated install</b> checkbox will be checked and details on why the installation was elevated will be given in the
<b>Client Side Privilege Details</b> and <b>Server Side Privilege Details</b> text boxes.&nbsp;
The following table describes what function each button on the
<b>
Detailed Log File View</b> dialog performs.<BR>
<table border="1" width="100%">
  <tr>
    <td width="20%"><b>Button</b></td>
    <td width="80%"><b>Function</b></td>
  </tr>
  <tr>
    <td width="20%">States</td>
    <td width="80%">Show the <b>Feature and Component States</b> dialog</td>
  </tr>
  <tr>
    <td width="20%">Properties</td>
    <td width="80%">Show the <b> Properties</b> dialog</td>
  </tr>
  <tr>
    <td width="20%">Policies</td>
    <td width="80%">Show the <b> Policies</b> dialog </td>
  </tr>
  <tr>
    <td width="20%">HTML Annotated Log</td>
    <td width="80%">Show the installation log output annotated in an HTML file that includes a legend describing each line's context and any useful information about the line</td>
  </tr>
  <tr>
    <td width="20%">Save Results</td>
    <td width="80%">Generate output files to the output directory currently set. For more information on the report files, see the <b> Report Files</b>
section in this document</td>
  </tr>
  <tr>
    <td width="20%">Error Message Help</td>
    <td width="80%">Show the error messages associated with the Windows Installer engine</td>
  </tr>
  <tr>
    <td width="20%">Help</td>
    <td width="80%">Show the help documentation for the Windows Installer Setup Log Analyzer tool</td>
  </tr>
  <tr>
    <td width="20%">How to Read a Log File </td>
    <td width="80%">Show the <b>How to Read a Log File</b> document</td>
  </tr>
</table>

<br>
<br>
<b>Options Dialog
</b>
<hr>
  The <b>Options</b> dialog is available from the <b>Operations</b> menu on the <b>Detailed Log File View</b> dialog.&nbsp;
The <b>options</b> dialog&nbsp;allows you to change the
HTML color for each specific area in the HTML file that can be generated by
selecting the <b>HTML Annotated Log </b>button on the <b>Detailed Log File View</b>
dialog.&nbsp; The <b> output directory</b> is the&nbsp;current directory the output report files and HTML
annotated log file will be sent to.&nbsp;<br>
<br>
<br>
<b>Feature and Component States Dialog</b>
<hr>
  The <b>Feature and Component States</b> dialog displays each of the features and components that where in the installation
package that the log was created for and what the state of each feature and component was at the end of the installation.&nbsp;
This can be&nbsp;useful when trying to find
out why a particular feature is not installing properly or when a file or
registry key is not&nbsp;being copied when expected.&nbsp; The
<b> Feature</b> column corresponds to the name for the feature that is given in the
installation package.&nbsp; The&nbsp;<b>Component</b> column corresponds to the name of the component that is given in the
installation package.&nbsp; The
<b>Installed</b> column&nbsp;represents the current state of the feature or
component.&nbsp; The <b>Request</b> column represents the selection made by the
end user during the installation for the feature or component.&nbsp; The
<b>Action</b> column represents the action that was taken by the Windows
Installer engine for the feature or component.&nbsp; For more detailed information on the
various states and what the values of each mean, please see the <b>MsiGetComponentState</b>
and <b>MsiGetFeatureState</b> function documentation in
the Windows Installer SDK help file (msi.chm).<br><br>

<br>
<b>Properties Dialog</b>
<hr>
  The <b>Properties</b> dialog will display the Windows Installer properties and their values at the end of the installation.&nbsp;
This dialog can be useful when you quickly need to know a particular value of a property like
<b>AdminUser</b>.&nbsp; On the <b>Properties</b> dialog, you can sort&nbsp;each of the properties either by
<b> name</b> or by <b>value</b>.&nbsp; The
<b> Client</b> tab shows all of the properties and their values during&nbsp;the client side of the installation.&nbsp;
The
<b> Server</b> tab shows all of the properties and their values during the server&nbsp;side of the installation.&nbsp;
The
<b> Nested</b> tab shows all of the properties and their values if the installation performed
involved a nested&nbsp;installation, that is one installation invoking
another Windows Installer based installation and resulting in the&nbsp;logging and overall
installation to be combined into a single piece.&nbsp; It will be rare that
you will see a nested&nbsp;installation, however, the <b> Nested</b> tab will provide you with
these properties if the&nbsp;installation in question has a nested
installation.<BR><br><BR>
<b>Policies Dialog
</b>
<hr>
  The <b> Policies</b> dialog displays the value of the machine and user policies set after the installation.&nbsp;
The value of a&nbsp;machine policy may cause functionality of the Windows Installer engine to behave differently. Currently, a value of
<b> 0</b> set for the policy means the policy is not enabled.&nbsp; A value of <b> 1 </b> means the policy was enabled.&nbsp;
A value of
<b> ?</b> means the policy value is unknown as it was not recorded in the windows installer log and thus not available.&nbsp;
If you need to&nbsp;a policy value that is unknown (marked with a
<b>?</b>), currently the best advice is to check the failing setup machines
registry keys manually using <b>regedit.exe</b>.&nbsp;&nbsp;
<p>For more information on the meaning of the specific machine and user policies,
please review the <b>System&nbsp;Policy</b> topic in Windows Installer Platform SDK help.&nbsp;
Another resource can be found in the following KB article: <b>Q227181 How to Manage Windows Installer Local
Policies</b>, <a href="http://support.microsoft.com/support/kb/articles/Q227/1/81.ASP">http://support.microsoft.com/support/kb/articles/Q227/1/81.ASP</a></p>

<p>&nbsp;</p>
<b>Quiet mode operation options</b>
<hr>
  Quiet mode operation is supported in an effort to allow setup testers and
developers to automate the log file analysis in a testing process.&nbsp; When the
log analyzer tool is ran in quiet mode, no user interface is displayed and only report files which&nbsp; includes an HTML annotated version of the log file are generated.&nbsp;
This can be useful to the setup tester as well as the setup developer in quickly providing
failure information on a specified setup.&nbsp; The following table list the valid command line options
that can be used for quiet mode operation.<BR>
<table border="1" width="100%">
  <tr>
    <td width="10%">&nbsp;<b>Option</b></td>
    <td width="60%">&nbsp;<b>Meaning</b></td>
    <td width="30%">&nbsp;<b>Notes</b></td>
  </tr>
  <tr>
    <td width="10%">&nbsp;/q</td>
    <td width="60%">&nbsp;specifies quiet mode installation</td>
    <td width="30%">&nbsp;Required</td>
  </tr>
  <tr>
    <td width="10%">&nbsp;/l</td>
    <td width="60%">&nbsp;specifies the log file name to do analysis on</td>
    <td width="30%">&nbsp;Required</td>
  </tr>
  <tr>
    <td width="10%">&nbsp;/o</td>
    <td width="60%">&nbsp;specifies the output directory for the report files and the HTML annotated log file</td>
    <td width="30%">&nbsp;Optional</td>
  </tr>
</table>

<br>
  Example usage for quiet mode operation:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b> WILogUtil /q /l c:\mymsilog.log /o
<a href="file:///c:/outputdir">c:\outputdir\<br>
</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WILogUtil /q /l c:\mymsilog.log</b><br>
<br>

<b>NOTES</b>:<BR>For quiet mode operation, only the <b>/q</b> and <b>/l</b> switches are required.&nbsp;
The <b>/o</b> switch is optional.&nbsp; When the optional <b>/o</b> switch is not specified, the output directory location specified in the options dialog is used.&nbsp;
The output directory passed via the <b>/o</b> switch will not affect the setting for the output directory location used when running
the <b>WILogUtil.exe</b> process in non-silent mode.&nbsp; When the <b>WILogUtil.exe</b>
process is executed in non-silent mode, none of the command line switches are used.
<br><br>If invalid command line arguments are passed for quiet mode operations, no action will be taken and the WILogUtil.exe process will return one of the values in the following table.
<BR>
<table border="1" width="75%">
  <tr>
    <td width="15%">&nbsp;<b>Value</b></td>
    <td width="85%">&nbsp;<b>Meaning</b></td>
  </tr>
  <tr>
    <td width="15%">1</td>
    <td width="85%">Bad output directory specified</td>
  </tr>
  <tr>
    <td width="15%">2</td>
    <td width="85%">Bad log file name specified</td>
  </tr>
  <tr>
    <td width="15%">3</td>
    <td width="85%">Passed /q, but missing required switch /l for the log file name</td>
  </tr>
  <tr>
    <td width="15%">4</td>
    <td width="85%">Passed /l, but missing required switch /q for quiet mode</td>
  </tr>
</table>

&nbsp;

<BR><BR>
<b>Report Files</b>
<hr>
  When doing a quiet mode analysis or clicking the <b> Save Results</b> button on the <b> Detailed Log File View</b> dialog,&nbsp;the Windows Installer Setup Analyzer tool will generate three report text files in addition to an HTML annotated log file.&nbsp;
The names and contents are in the following table.
<BR>
<table border="1" width="100%">
  <tr>
    <td width="20%"><b>Filename</b></td>
    <td width="80%"><b>Description</b></td>
  </tr>
  <tr>
    <td width="20%">logfilename_summary.txt</td>
    <td width="80%">Has a summary of the log file with the information displayed on the Detailed Log File View dialog including the first error found</td>
  </tr>
  <tr>
    <td width="20%">logfilename_errors.txt</td>
    <td width="80%">Has the number of critical errors found along with the critical errors and the solutions to each error.&nbsp;
      This file will also have the number of non-critical errors, the non-critical errors and the solutions to each error</td>
  </tr>
  <tr>
    <td width="20%">logfilename_policies.txt</td>
    <td width="80%">Has the policy names and values set at the end of the
      installation.&nbsp; For more&nbsp;information on the policies and the meaning of each, see the Policies dialog documentation in this document</td>
  </tr>
  <tr>
    <td width="20%">details_logfilename.htm</td>
    <td width="80%">An HTML annotated log that has the legend included.&nbsp; The various colors decribe each line and can provide information that may be useful</td>
  </tr>
</table>

</body>

</html>
