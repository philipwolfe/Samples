<html DIR="LTR"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; CHARSET=utf-8" /><META NAME="save" CONTENT="history" /><title>Saving an XPS Document Sample</title><META NAME="Description" CONTENT="XpsSave shows how to write an XML Paper Specification (XPS) document to a file either synchronously[Glossary Lookup Failure: synchronous#c61957af-3823-41bd-9c97-e0d815070611] or asynchronously[Glossary Lookup Failure: asynchronous#629d7901-119a-44e1-a2d1-e94e4fe3af25]. When executed, the sample displays a &quot;Select Content&quot; ComboBox that allows the user to choose one of five predefined content types–a single visual, multiple visuals, a flow document, a single fixed document, or multiple fixed documents. The selected content is displayed in DocumentViewer control located in the right pane of the application window. After the content is selected, two print buttons are enabled: &quot;Save - Synchronous&quot; and &quot;Save -Asynchronous&quot;. Pressing either button opens a &quot;Save As...&quot; dialog that then initiates writing the XML Paper Specification (XPS) document to a specified file."></META><META NAME="MS.LOCALE" CONTENT="en-us" /><style>
body
{font-family:Verdana;font-size:medium;}
div#mainSection, div#header
{font-size:70%;width: 100%;}
div#mainBody
{font-size:90%;}
div#mainSection div table
{font-size: 100%;text-align: left;}
span#nsrTitle
{color:#003399;font-size:90%;font-weight:600;}
div#header
{background-color:#D4DFFF;}
.heading
{font-size:120%;color:#003399;}
.subHeading
{font-size:100%;margin-bottom:4;}
li
{margin-top:-2;margin-bottom:3;}
p
{margin-top:10;margin-bottom:5;}
div.tableSection p
{margin-top:1;margin-bottom:4;}	
div#mainSection table th
{background-color:#EFEFF7;color:#000066;text-align:left;}
div#mainSection table td
{background-color:#F7F7FF;}
div#mainSection table
{margin-top:5px;margin-bottom: px;}
			</style></head><body><div id="header"><table width="100%" id="topTable"><tr id="headerTableRow2"><td align="left"><span id="nsrTitle">Saving an XPS Document Sample</span></td></tr></table></div><div id="mainSection"><div id="mainBody"><br /><font color="DarkGray">[This readme is a partial copy of the sample's topic in the SDK documentation.]</font><br /><p><i>XpsSave</i> shows how to write an XML Paper Specification (XPS) document to a file either synchronously[<B style="color:red"><I>Glossary Lookup Failure: synchronous#c61957af-3823-41bd-9c97-e0d815070611</I></B>] or asynchronously[<B style="color:red"><I>Glossary Lookup Failure: asynchronous#629d7901-119a-44e1-a2d1-e94e4fe3af25</I></B>].  When executed, the sample displays a "Select Content" ComboBox that allows the user to choose one of five predefined content types–a single visual, multiple visuals, a flow document, a single fixed document, or multiple fixed documents.  The selected content is displayed in DocumentViewer control located in the right pane of the application window. After the content is selected, two print buttons are enabled: "Save - Synchronous" and "Save -Asynchronous".  Pressing either button opens a "Save As..." dialog that then initiates writing the XML Paper Specification (XPS) document to a specified file.    </p><p>"Save - Synchronous" shows the basic operations for writing an XPS document.  During synchronous writing the user interface waits until the output completes.  Waiting for writing to complete might be satisfactory for small documents where the output time is quick, but is generally not recommended since large documents might take a relatively significant amount of time to save.</p><p>"Save - Asynchronous" allows the user interface to continue while the XPS write operation proceeds independently.  Asynchronous saving requires a small amount of additional code set up, but is the recommended "best practice" to maintain a responsive user interface.</p><p>This sample demonstrates a specific feature of the Windows Presentation Foundation (WPF) and, consequently, does not follow application development best practices. For comprehensive coverage of Windows Presentation Foundation (WPF) and Microsoft .NET Framework application development best practices, refer to the following as appropriate:</p><p>Accessibility - Accessibility Best Practices</p><p>Security - WPF Security</p><p>Localization - WPF Globalization and Localization Overview</p><h1 class="heading">Building the Sample</h1><div id="sectionSection0" class="seeAlsoNoToggleSection"><h3 class="subHeading">Procedure Title</h3><div class="subSection"><ol><li><p>
                Install the Windows Software Development Kit (SDK) and open its build environment command window. On the Start menu, point to All Programs, Microsoft Windows SDK, and then click CMD Shell.
              </p></li><li><p>
                Download the sample, usually from the software development kit (SDK) documentation, to your hard disk drive.
              </p></li><li><p>
                To build the sample from the build environment command window, go to the source directory of the sample. At the command prompt, type MSBUILD.
              </p></li><li><p>
                To build the sample in Microsoft Visual Studio 2005, load the sample solution or project file and then press CTRL+SHIFT+B.
              </p></li></ol></div></div><h1 class="heading">Running the Sample</h1><div id="sectionSection1" class="seeAlsoNoToggleSection"><ul><li><p>
            To run the compiled sample with debugging in Visual Studio 2005, press F5.
          </p></li><li><p>To run the sample from a CMD Shell command window, execute the .exe file located in the source folder of the sample.</p></li></ul></div><h1 class="heading">See Also</h1><div id="seeAlsoSection" class="seeAlsoNoToggleSection"><h4 class="subHeading">Tasks</h4><a href="a7736471-4322-40ea-8580-34c8eb0dbb3e.htm">Creating an XPS Document Sample</a><br /><a href="849555c8-0c4e-48c0-86bc-a5494c69b36c.htm">Printing an XPS Document</a><br /><a href="77b4c6e1-4023-4f37-a494-5dfda34075c4.htm">Read-Write-Sign an XPS Document Sample</a><br /><a href="449a67e0-52ee-46b7-a6ea-be81a557ec94.htm">Reading a Package Sample</a><br /><a href="339dc5e1-da68-4683-a5ef-e0b0e99f3ad8.htm">Writing a Package Sample</a><br /><h4 class="subHeading">Other Resources</h4>Documents In Windows Presentation Foundation<br />Document Serialization and Storage<br /><br /></div><UscDataIsland></UscDataIsland></div></div></body></html>